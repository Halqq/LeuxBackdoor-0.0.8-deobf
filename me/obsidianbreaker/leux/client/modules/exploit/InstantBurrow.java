package me.obsidianbreaker.leux.client.modules.exploit;

import give up;
import me.obsidianbreaker.leux.client.guiscreen.settings.Setting;
import me.obsidianbreaker.leux.client.modules.Category;
import me.obsidianbreaker.leux.client.modules.Module;
import me.obsidianbreaker.leux.client.util.MessageUtil;
import net.minecraft.block.Block;
import net.minecraft.entity.Entity;
import net.minecraft.init.Blocks;
import net.minecraft.item.Item;
import net.minecraft.item.ItemBlock;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.CPacketEntityAction;
import net.minecraft.network.play.client.CPacketPlayer;
import net.minecraft.util.EnumFacing;
import net.minecraft.util.math.AxisAlignedBB;
import net.minecraft.util.math.BlockPos;
import net.minecraft.util.math.Vec3d;
import net.minecraft.world.World;

public class InstantBurrow extends Module {
  public float oldTickLength = mc.field_71428_T.field_194149_e;
  
  public Setting rotate = create("Rotate", "Rotate", false);
  
  public Setting silent = create("Silent", "Silent", true);
  
  public Setting enderchest = create("Ender Chest", "EnderChest", true);
  
  public Setting height = create("Height", "Height", 3, 0, 30);
  
  public BlockPos originalPos;
  
  public void enable() {
    (give up)null;
    if (mc.field_71439_g == null || mc.field_71441_e == null)
      return; 
    int i = mc.field_71439_g.field_71071_by.field_70461_c;
    this.oldTickLength = mc.field_71428_T.field_194149_e;
    this.originalPos = new BlockPos(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u, mc.field_71439_g.field_70161_v);
    if (mc.field_71441_e.func_180495_p(new BlockPos(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u, mc.field_71439_g.field_70161_v)).func_177230_c().equals(Blocks.field_150343_Z) || mc.field_71441_e.func_180495_p(new BlockPos(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u, mc.field_71439_g.field_70161_v)).func_177230_c().equals(Blocks.field_150477_bB)) {
      MessageUtil.send_client_message("You are already in Obsidian / Ender Chest");
      set_disable();
      return;
    } 
    if (isInterceptedByOther(this.originalPos)) {
      MessageUtil.send_client_message("You are intercepted by an entity");
      set_disable();
      return;
    } 
    if (getHotbarSlot(Blocks.field_150343_Z) == -1 && getHotbarSlot(Blocks.field_150477_bB) == -1) {
      MessageUtil.send_client_message("You don't have Obsidian or EnderChest in your hotbar");
      set_disable();
      return;
    } 
    if (!mc.field_71441_e.func_180495_p(this.originalPos.func_177982_a(0, 1, 0)).func_177230_c().equals(Blocks.field_150350_a) || !mc.field_71441_e.func_180495_p(this.originalPos.func_177982_a(0, 2, 0)).func_177230_c().equals(Blocks.field_150350_a) || !mc.field_71441_e.func_180495_p(this.originalPos.func_177982_a(0, 3, 0)).func_177230_c().equals(Blocks.field_150350_a)) {
      MessageUtil.send_client_error_message("Not enough space!");
      set_disable();
      return;
    } 
    if (mc.func_71356_B()) {
      MessageUtil.send_client_error_message("You are in singleplayer!");
      set_disable();
      return;
    } 
    if (this.silent.get_value(true))
      mc.field_71428_T.field_194149_e = Float.intBitsToFloat(1.09630669E9F ^ 0x7ED85021); 
    mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketPlayer.Position(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u + 0.41999998688698D, mc.field_71439_g.field_70161_v, true));
    mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketPlayer.Position(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u + 0.7531999805211997D, mc.field_71439_g.field_70161_v, true));
    mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketPlayer.Position(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u + 1.00133597911214D, mc.field_71439_g.field_70161_v, true));
    mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketPlayer.Position(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u + 1.16610926093821D, mc.field_71439_g.field_70161_v, true));
    mc.field_71439_g.func_70107_b(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u + 1.16610926093821D, mc.field_71439_g.field_70161_v);
    if (this.enderchest.get_value(true) && getHotbarSlot(Blocks.field_150477_bB) != -1) {
      mc.field_71439_g.field_71071_by.field_70461_c = getHotbarSlot(Blocks.field_150477_bB);
    } else if (getHotbarSlot(Blocks.field_150343_Z) != -1) {
      mc.field_71439_g.field_71071_by.field_70461_c = getHotbarSlot(Blocks.field_150343_Z);
    } else {
      mc.field_71439_g.field_71071_by.field_70461_c = getHotbarSlot(Blocks.field_150477_bB);
    } 
    placeBlock(this.originalPos, this.rotate.get_value(true), true, false, true, false);
    mc.field_71439_g.field_71071_by.field_70461_c = i;
    mc.field_71439_g.func_70107_b(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u - 1.16610926093821D, mc.field_71439_g.field_70161_v);
    mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketPlayer.Position(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u + this.height.get_value(1), mc.field_71439_g.field_70161_v, true));
    mc.field_71428_T.field_194149_e = this.oldTickLength;
    set_disable();
  }
  
  public static boolean isIntercepted(BlockPos paramBlockPos) {
    (give up)null;
    for (Entity entity : mc.field_71441_e.field_72996_f) {
      if ((new AxisAlignedBB(paramBlockPos)).func_72326_a(entity.func_174813_aQ()))
        return true; 
    } 
    return false;
  }
  
  public static int getHotbarSlot(Block paramBlock) {
    (give up)null;
    byte b = 0;
    while (true) {
      9;
      Item item = mc.field_71439_g.field_71071_by.func_70301_a(b).func_77973_b();
      if (item instanceof ItemBlock && ((ItemBlock)item).func_179223_d().equals(paramBlock))
        return b; 
    } 
  }
  
  public static InstantBurrow$BlockResistance getBlockResistance(BlockPos paramBlockPos) {
    (give up)null;
    return mc.field_71441_e.func_175623_d(paramBlockPos) ? InstantBurrow$BlockResistance.Blank : ((mc.field_71441_e.func_180495_p(paramBlockPos).func_177230_c().func_176195_g(mc.field_71441_e.func_180495_p(paramBlockPos), (World)mc.field_71441_e, paramBlockPos) != Float.intBitsToFloat(-1.05557888E9F ^ 0x7E9524F7) && !mc.field_71441_e.func_180495_p(paramBlockPos).func_177230_c().equals(Blocks.field_150343_Z) && !mc.field_71441_e.func_180495_p(paramBlockPos).func_177230_c().equals(Blocks.field_150467_bQ) && !mc.field_71441_e.func_180495_p(paramBlockPos).func_177230_c().equals(Blocks.field_150381_bn) && !mc.field_71441_e.func_180495_p(paramBlockPos).func_177230_c().equals(Blocks.field_150477_bB)) ? InstantBurrow$BlockResistance.Breakable : ((mc.field_71441_e.func_180495_p(paramBlockPos).func_177230_c().equals(Blocks.field_150343_Z) || mc.field_71441_e.func_180495_p(paramBlockPos).func_177230_c().equals(Blocks.field_150467_bQ) || mc.field_71441_e.func_180495_p(paramBlockPos).func_177230_c().equals(Blocks.field_150381_bn) || mc.field_71441_e.func_180495_p(paramBlockPos).func_177230_c().equals(Blocks.field_150477_bB)) ? InstantBurrow$BlockResistance.Resistant : (mc.field_71441_e.func_180495_p(paramBlockPos).func_177230_c().equals(Blocks.field_150357_h) ? InstantBurrow$BlockResistance.Unbreakable : null)));
  }
  
  public static void placeBlock(BlockPos paramBlockPos, boolean paramBoolean1, boolean paramBoolean2, boolean paramBoolean3, boolean paramBoolean4, boolean paramBoolean5) {
    paramBoolean5 = false;
    paramBoolean4 = true;
    paramBoolean3 = false;
    paramBoolean2 = true;
    (give up)null;
    for (EnumFacing enumFacing : EnumFacing.values()) {
      if (getBlockResistance(paramBlockPos.func_177972_a(enumFacing)) != InstantBurrow$BlockResistance.Blank && !isIntercepted(paramBlockPos)) {
        Vec3d vec3d = new Vec3d(paramBlockPos.func_177958_n() + 0.5D + enumFacing.func_82601_c() * 0.5D, paramBlockPos.func_177956_o() + 0.5D + enumFacing.func_96559_d() * 0.5D, paramBlockPos.func_177952_p() + 0.5D + enumFacing.func_82599_e() * 0.5D);
        float[] arrayOfFloat = { mc.field_71439_g.field_70177_z, mc.field_71439_g.field_70125_A };
        mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketPlayer.Rotation((float)Math.toDegrees(Math.atan2(vec3d.field_72449_c - mc.field_71439_g.field_70161_v, vec3d.field_72450_a - mc.field_71439_g.field_70165_t)) - Float.intBitsToFloat(1.03471302E9F ^ 0x7F1877B5), (float)-Math.toDegrees(Math.atan2(vec3d.field_72448_b - mc.field_71439_g.field_70163_u + mc.field_71439_g.func_70047_e(), Math.sqrt((vec3d.field_72450_a - mc.field_71439_g.field_70165_t) * (vec3d.field_72450_a - mc.field_71439_g.field_70165_t) + (vec3d.field_72449_c - mc.field_71439_g.field_70161_v) * (vec3d.field_72449_c - mc.field_71439_g.field_70161_v)))), mc.field_71439_g.field_70122_E));
        mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketEntityAction((Entity)mc.field_71439_g, CPacketEntityAction.Action.START_SNEAKING));
      } 
    } 
  }
  
  public static boolean isInterceptedByOther(BlockPos paramBlockPos) {
    (give up)null;
    for (Entity entity : mc.field_71441_e.field_72996_f) {
      if (!entity.equals(mc.field_71439_g) && (new AxisAlignedBB(paramBlockPos)).func_72326_a(entity.func_174813_aQ()))
        return true; 
    } 
    return false;
  }
  
  public InstantBurrow() {
    super(Category.exploit);
  }
}
