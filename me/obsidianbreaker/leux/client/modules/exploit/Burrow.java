package me.obsidianbreaker.leux.client.modules.exploit;

import com.mojang.realmsclient.gui.ChatFormatting;
import give up;
import me.obsidianbreaker.leux.client.guiscreen.settings.Setting;
import me.obsidianbreaker.leux.client.modules.Category;
import me.obsidianbreaker.leux.client.modules.Module;
import me.obsidianbreaker.leux.client.util.BlockInteractHelper;
import me.obsidianbreaker.leux.client.util.InventoryUtil;
import me.obsidianbreaker.leux.client.util.MessageUtil;
import me.obsidianbreaker.leux.client.util.PlayerUtil;
import net.minecraft.init.Blocks;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.CPacketPlayer;
import net.minecraft.util.math.BlockPos;
import net.minecraft.util.math.Vec3d;

public class Burrow extends Module {
  public Setting jump = create("Jump", "Jump", "Classic", combobox(new String[] { "Classic", "Packet" }));
  
  public BlockPos originalPos;
  
  public Setting height = create("Height", "Height", 3, 0, 30);
  
  public Vec3d center = null;
  
  public Setting centerplayer = create("Center Player", "CenterPlayer", false);
  
  public float oldTickLength = mc.field_71428_T.field_194149_e;
  
  public int timeout_ticker = 0;
  
  public Setting rubberband = create("Rubberband", "Rubberband", "Packet", combobox(new String[] { "Classic", "Secure", "Packet" }));
  
  public Setting instant = create("Instant", "Instant", true);
  
  public Setting enderchest = create("Ender Chest", "EnderChest", true);
  
  public void update() {
    (give up)null;
    if (this.timeout_ticker > 40) {
      this.timeout_ticker = 0;
      set_disable();
    } else if (mc.field_71439_g.field_70163_u > this.originalPos.func_177956_o() + 1.2D) {
      int i = mc.field_71439_g.field_71071_by.field_70461_c;
      if (this.enderchest.get_value(true) && InventoryUtil.getHotbarSlot(Blocks.field_150477_bB) != -1) {
        mc.field_71439_g.field_71071_by.field_70461_c = InventoryUtil.getHotbarSlot(Blocks.field_150477_bB);
      } else if (InventoryUtil.getHotbarSlot(Blocks.field_150343_Z) != -1) {
        mc.field_71439_g.field_71071_by.field_70461_c = InventoryUtil.getHotbarSlot(Blocks.field_150343_Z);
      } else {
        mc.field_71439_g.field_71071_by.field_70461_c = InventoryUtil.getHotbarSlot(Blocks.field_150477_bB);
      } 
      BlockInteractHelper.placeBlock(this.originalPos);
      mc.field_71439_g.field_71071_by.field_70461_c = i;
      if (this.rubberband.in("Classic")) {
        mc.field_71439_g.func_70664_aZ();
      } else if (this.rubberband.in("Secure")) {
        mc.field_71439_g.field_70181_x = this.height.get_value(1);
      } else {
        mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketPlayer.Position(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u + this.height.get_value(1), mc.field_71439_g.field_70161_v, false));
      } 
      set_disable();
    } 
    this.timeout_ticker++;
  }
  
  public void disable() {
    (give up)null;
    mc.field_71428_T.field_194149_e = this.oldTickLength;
  }
  
  public String array_detail() {
    (give up)null;
    return this.jump.get_current_value() + " + " + this.rubberband.get_current_value();
  }
  
  public void enable() {
    (give up)null;
    this.timeout_ticker = 0;
    this.oldTickLength = mc.field_71428_T.field_194149_e;
    this.originalPos = new BlockPos(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u, mc.field_71439_g.field_70161_v);
    this.center = PlayerUtil.getCenter(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u, mc.field_71439_g.field_70161_v);
    if (mc.field_71441_e.func_180495_p(new BlockPos(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u, mc.field_71439_g.field_70161_v)).func_177230_c().equals(Blocks.field_150343_Z) || mc.field_71441_e.func_180495_p(new BlockPos(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u, mc.field_71439_g.field_70161_v)).func_177230_c().equals(Blocks.field_150477_bB)) {
      MessageUtil.send_client_error_message("" + ChatFormatting.RESET + "You are already in Obsidian / Ender Chest");
      set_disable();
      return;
    } 
    if (BlockInteractHelper.isInterceptedByOther(this.originalPos)) {
      MessageUtil.send_client_error_message("" + ChatFormatting.RESET + "You are intercepted by an entity");
      set_disable();
      return;
    } 
    if (InventoryUtil.getHotbarSlot(Blocks.field_150343_Z) == -1 && InventoryUtil.getHotbarSlot(Blocks.field_150477_bB) == -1) {
      MessageUtil.send_client_error_message("" + ChatFormatting.RESET + "You don't have Obsidian or EnderChest in your hotbar");
      set_disable();
      return;
    } 
    if (!mc.field_71441_e.func_180495_p(this.originalPos.func_177982_a(0, 1, 0)).func_177230_c().equals(Blocks.field_150350_a) || !mc.field_71441_e.func_180495_p(this.originalPos.func_177982_a(0, 2, 0)).func_177230_c().equals(Blocks.field_150350_a) || !mc.field_71441_e.func_180495_p(this.originalPos.func_177982_a(0, 3, 0)).func_177230_c().equals(Blocks.field_150350_a)) {
      MessageUtil.send_client_error_message("Not enough space!");
      set_disable();
      return;
    } 
    if (mc.func_71356_B()) {
      MessageUtil.send_client_error_message("You are in singleplayer!");
      set_disable();
      return;
    } 
    if (this.centerplayer.get_value(true)) {
      mc.field_71439_g.field_70159_w = 0.0D;
      mc.field_71439_g.field_70179_y = 0.0D;
      mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketPlayer.Position(this.center.field_72450_a, this.center.field_72448_b, this.center.field_72449_c, false));
      mc.field_71439_g.func_70107_b(this.center.field_72450_a, this.center.field_72448_b, this.center.field_72449_c);
    } 
    if (this.instant.get_value(true))
      mc.field_71428_T.field_194149_e = Float.intBitsToFloat(1.0848169E9F ^ 0x7F28FDEB); 
    if (this.jump.in("Packet")) {
      mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketPlayer.Position(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u + 0.41999998688698D, mc.field_71439_g.field_70161_v, false));
      mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketPlayer.Position(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u + 0.7531999805211997D, mc.field_71439_g.field_70161_v, false));
      mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketPlayer.Position(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u + 1.00133597911214D, mc.field_71439_g.field_70161_v, false));
      mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketPlayer.Position(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u + 1.16610926093821D, mc.field_71439_g.field_70161_v, false));
      mc.field_71439_g.field_71174_a.func_147297_a((Packet)new CPacketPlayer.Position(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u + 1.4610926093821D, mc.field_71439_g.field_70161_v, false));
    } else {
      mc.field_71439_g.func_70664_aZ();
    } 
  }
  
  public Burrow() {
    super(Category.exploit);
  }
}
